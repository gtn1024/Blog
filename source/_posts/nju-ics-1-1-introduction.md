---
title: 计算机系统基础（一）学习笔记：计算机系统概述
date: 2024-01-29 18:37:29
tags:
- 计算机系统基础
---

好久没写博客了，打了两年的算法竞赛，在 ICPC 2023 杭州区域赛拿了学校第一枚铜牌以后也退役了。

一直以来都想找机会补一补 CS 基础相关的，顺着 [jyy](https://space.bilibili.com/202224425) 和 [why](https://space.bilibili.com/49964811) 老师的 B 站，找到了南大袁春风老师的计算机系统基础理论课课程。（微机原理的老师：“？”）

这是计算机系统基础系列课程的第一门，主要涉及程序的表示、转换与链接。课程链接：<https://www.icourse163.org/course/NJU-1001625001>

本文主要整理本课程第一周（计算机系统概述）的内容。

<!-- more -->

## 为什么要学习计算机系统

计算机系统抽象如下：

{% asset_img cs-abstraction.png %}

程序执行结果仅仅取决于算法、程序编写，还取决于语言处理系统、操作系统、ISA、微体系结构。计算机课程涉及到不同的层次。

计算机系统课程目标是清楚计算机是如何生成和运行可执行文件。从程序出发，重点在高级语言以下各抽象层。

课程主要包含如下内容：

- C 语言程序设计层
  - 数据的机器级表示、运算
  - 语句和过程调用的机器级表示
- 操作系统、编译和链接的部分内容
- 指令集体系结构（ISA）和汇编层
  - 指令系统、机器代码、汇编语言
- 微体系结构及硬件层
  - CPU 的通用结构
  - 层次结构存储系统

## 冯·诺依曼结构

{% asset_img von-model.png %}

在早期，部件之间用 **分散方式** 相连；现在主要使用 **总线方式**。

冯诺依曼结构的主要思想如下：

1. 计算机由运算器、控制器、存储器、输入设备、输出设备五个基本部件组成。
2. 各基本部件的功能是：
  - **存储器**：不仅能存放数据，而且能存放指令，形式上两者没有区别，但计算机应能够区分数据和指令；
  - **控制器**：应能够自动取出指令来执行；
  - **运算器**：应能够进行加减乘除四种基本算术运算，而且能进行一些逻辑运算和附加运算；
  - 操作人员可以通过 **输入设备**、**输出设备** 和主机进行通信。
3. 内部以二进制表示指令和数据。每条指令由操作码和地址码两部分组成。操作码指出操作类型，地址码指出操作数的地址。由一串指令组成程序。
4. 采用 **存储程序** 的工作方式。

## 现代计算机结构模型

现代计算机与冯诺依曼结构类似，同样是由 5 大基本部件组成。其中，**运算器**、**控制器** 在 CPU 中实现。

{% asset_img current-model.png %}

术语说明：

- CPU：中央处理器
- PC：程序计数器
- MAR：存储器地址寄存器
- ALU：算术逻辑部件
- IR：指令寄存器
- MDR：存储器数据寄存器
- GPRs：通用寄存器组（由若干通用寄存器组成，早期为累加器）

## 程序设计语言

### 机器语言

最早，人们使用机器语言来编写程序，并记录在纸带或者卡片上。

例如：

```
0: 0101 0110
1: 0010 0100
2: ...
3: ...
4: 0100 0111
5: ...
6: ...
```

若在指令之间加入其他指令，需要重新计算地址码，十分麻烦。机器语言对于书写、阅读十分麻烦。

### 汇编语言

将如上机器语言代码翻译为汇编语言：

```asm
    add B
    jc L0
    ...
    ...
L0: sub C
    ...
B:  ...
C:  ...
```

为简化程序编写，汇编语言出现了。汇编语言使用 **助记符** 表示操作码，用标号表示位置，用助记符表示寄存器。

对于计算机来说，汇编语言并不能被直接执行，需要通过汇编器将其翻译为机器语言。

汇编源程序由汇编指令构成。汇编指令使用助记符和标号来表示指令（与机器指令一一对应）。指令包含操作码和操作数或其地址码，只能描述简单操作。

但是，使用汇编语言编写的程序有很大问题。如，需要描述的细节太多，编码过长。且在不同机器上无法通用。

### 高级语言

高级语言与具体机器结构无关。其面向算法描述，比机器级语言描述能力强很多。高级语言中一条语句可以对应多条指令。

高级语言无法被计算机直接执行，需要转换为机器语言。转换方式主要有 **编译** 和 **解释**。

- 编译：将高级语言程序转换为机器级目标程序，执行时只需要启动目标程序即可。
- 解释：将高级语言程序逐条翻译为机器指令并执行，不生成目标程序。

例如，在 GCC 环境中。如下程序转换过程如下：

```c
#include <stdio.h>
int main()
{
  printf("Hello World!\n");
}
```

{% asset_img c-compile-proc.png %}

### 不同层次语言之间的等价转换

{% asset_img language-convert.png %}

## 指令集体系结构（ISA）

ISA 是指 Instruction Set Architecture，即 **指令集体系结构**，有时简称为 **指令系统**。

ISA 是一种规约，它规定了如何使用硬件

- 可执行的指令的集合，包括 **指令格式**、**操作种类** 以及每种操作对应的操作数的相应规定；
- 指令可以接受的 **操作数的类型**；
- 操作数所能存放的寄存器组的结构，包括每个 **寄存器的名称、编号、长度和用途**；
- 操作数所能存放的 **存储空间的大小和编址方式**；
- 操作数在存储空间存放时按照 **大端还是小端方式存放**；
- 指令获取操作数的方式，即 **寻址方式**；
- 指令执行过程的控制方式，包括 **程序计数器（PC）**、**条件码定义** 等。

ISA 在 **通用** 计算机系统中是必不可少的一个抽象层。
